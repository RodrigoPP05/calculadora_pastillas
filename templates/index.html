<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculadora de Rendimiento de Pastillas</title>
    <style>
        body {
            background-color: #1e1e2f;
            font-family: 'Segoe UI', sans-serif;
            color: white;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        label {
            display: block;
            margin: 10px 0 4px;
        }
        input, select {
            padding: 6px;
            width: 200px;
            margin-bottom: 10px;
            border: none;
            border-radius: 5px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .checkbox-toggle {
            margin-top: 10px;
        }
        .extra-fields {
            display: none;
        }
        .extra-fields.visible {
            display: block;
        }
        .submit-btn {
            background-color: #2ce4c4;
            color: black;
            padding: 10px 20px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            border: none;
            margin-top: 10px;
        }
    </style>
    <script>
        function toggleExtraFields() {
            const checkbox = document.getElementById("usar_costos_extra");
            const extras = document.getElementById("extra_fields");
            extras.classList.toggle("visible", checkbox.checked);
        }
    </script>
</head>
<body>
    <h1>Calculadora de rendimiento de pastillas</h1>

    <form method="POST">
        <div class="form-group">
            <label>Diámetro de oblea:</label>
            <input type="number" step="any" name="diametro" required>
            <select name="udiam">
                <option value="cm">cm</option>
                <option value="pulgadas">pulgadas</option>
                <option value="m">m</option>
                <option value="pies">pies</option>
            </select>
        </div>

        <div class="form-group">
            <label>Lado de pastilla:</label>
            <input type="number" step="any" name="lado" required>
            <select name="ulado">
                <option value="cm">cm</option>
                <option value="pulgadas">pulgadas</option>
                <option value="m">m</option>
                <option value="pies">pies</option>
            </select>
        </div>

        <div class="form-group">
            <label>Densidad de defectos (/cm²):</label>
            <input type="number" step="any" name="densidad" required>
        </div>

        <div class="form-group">
            <label>Costo de la oblea (USD):</label>
            <input type="number" step="any" name="costo" required>
        </div>

        <div class="form-group">
            <label>Rendimiento por Oblea (%):</label>
            <input type="number" step="any" name="Rendimiento Por Oblea" placeholder="100">
            <small>(Si se deja en blanco, se asumirá como 100%)</small>
        </div>

        <div class="form-group checkbox-toggle">
            <label>
                <input type="checkbox" id="usar_costos_extra" name="usar_costos_extra" onchange="toggleExtraFields()">
                Usar datos para calcular el costo del circuito integrado (IC)
            </label>
        </div>

        <div id="extra_fields" class="extra-fields">
            <div class="form-group">
                <label>Costo de prueba por pastilla (USD):</label>
                <input type="number" step="any" name="costo_prueba">
            </div>

            <div class="form-group">
                <label>Costo de empaquetado y prueba final (USD):</label>
                <input type="number" step="any" name="costo_empaque">
            </div>

            <div class="form-group">
                <label>Rendimiento final de prueba (%):</label>
                <input type="number" step="any" name="rendimiento_final">
            </div>
        </div>

        <button type="submit" class="submit-btn">Calcular</button>
    </form>

    {% if resultado %}
    <hr>
    <h2>Resultados</h2>
    <ul>
        <li><b>Área de la oblea:</b> {{ resultado.wafer }} cm²</li>
        <li><b>Área del chip:</b> {{ resultado.chip }} cm²</li>
        <li><b>Pastillas por oblea:</b> {{ resultado.total }}</li>
        <li><b>Rendimiento (%):</b> {{ resultado.rendimiento }}%</li>
        <li><b>Pastillas buenas:</b> {{ resultado.buenas }}</li>
        <li><b>Costo por pastilla:</b> ${{ resultado.costo }}</li>
        {% if resultado.costo_ic %}
        <li><b>Costo del circuito integrado (IC):</b> ${{ resultado.costo_ic }}</li>
        {% endif %}
    </ul>
    {% endif %}
</body>
</html>
